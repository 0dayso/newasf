<?php//行线	$url=$_GET['url']?$_GET['url']:"";	//域名信息	$data=getinfo($url);		$preg="/>(.*到.*)<\/a>/Ui";	preg_match_all($preg,$data,$info);					$conn=mysql_connect("localhost","root","77169"); 	mysql_select_db("curl_data");	mysql_query("set names utf8");$val='';	foreach($info[1] as $v ){		$v=strip_tags($v);		$v=str_replace('机票','',$v);		$v=explode('到',$v);		$v[0]=iconv('GB2312','UTF-8',$v[0]);			$v[1]=iconv('GB2312','UTF-8',$v[1]);				$val.="('$v[0]','$v[1]'),";	}	$val=trim($val,',');			$sql="insert into line_temp (`from`,`to`)values $val;";  	echo $sql;			mysql_query($sql) or die(mysql_error());	exit;	function getinfo($url){	//获取内容$headers = array("Connection: keep-alive","Cache-Control: max-age=0","Accept: application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5","User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US)","Avail-Dictionary: xdC_A6dv","Accept-Language: zh-CN,zh;q=0.8","Accept-Charset: utf-8;GBK,q=0.7,*;q=0.3"		);		$cookie_file=dirname(__FILE__).'/cookie.txt';		$ch = curl_init();		curl_setopt ($ch,CURLOPT_URL, $url);		curl_setopt ($ch,CURLOPT_RETURNTRANSFER, 1); 		curl_setopt ($ch,CURLOPT_CONNECTTIMEOUT,10); 	//	curl_setopt($ch,CURLOPT_POST,1);	//	curl_setopt($ch,CURLOPT_POSTFIELDS,$curlPost);		curl_setopt($ch,CURLOPT_HTTPHEADER, $headers);		curl_setopt($ch,CURLOPT_COOKIEJAR,$cookie_file);		curl_setopt($ch,CURLOPT_COOKIEFILE,$cookie_file);			//引入cookie 文件		$newfile = curl_exec($ch);		return $newfile;}?>